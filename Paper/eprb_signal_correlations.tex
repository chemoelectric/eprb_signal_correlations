%% THIS TECHNOTE IS A WORK IN PROGRESS

\documentclass[9pt,technote]{IEEEtran}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{array}
\usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
\usepackage{textcomp}
\usepackage{stfloats}
\usepackage{url}
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{cite}
\hyphenation{op-tical net-works semi-conduc-tor IEEE-Xplore}

\begin{document}

\title{Correlation Coefficient of a Two-Channel Bell Test\\by
  Probability Theory}
\author{Barry~Schwartz,~\IEEEmembership{Member,~IEEE}}

\maketitle

\begin{abstract}
  It is widely believed that only quantum mechanics can characterize
  the correlations of a Bell test. In fact, quantum mechanics is
  superfluous to the problem, and a correlation coefficient may be
  derived by probability theory.
\end{abstract}

\section{Introduction}

John~S. Bell famously proposed a test {\bf{FILL IN REFERENCE HERE}}
supposed to prove that quantum mechanics was, in essence, magical. I
put the matter this way because the proposed test is soluble by
probability theory, and yet Bell seems to have claimed quantum
mechanics alone could provide the One True Answer that surpassed all
other solutions. At the time of this writing, Bell's test is
considered passed and the matter resolved in favor of the One True
Answer.

Of course, what actually happened is that Bell {\em{did not know}} the
test could be analyzed by means other than quantum mechanics, and also
surely {\em{already entertained the notion}} that quantum mechanics
might indeed be magical. Quantum mechanics has widely been regarded as
some kind of ``magic'' for a very long time. However, some of us do
not---at least when supposedly engaged in the scientific
endeavor---entertain the notion that magic---or, indeed, anything
remotely resembling it---exists. Furthermore, the Bell test problem is
not, in fact, one of quantum mechanics at all. It is more properly a
problem in random process analysis. It merely happens that quantum
mechanics ``knows'' how to solve such a problem, without the user
having to understand the subject of random process analysis.

We, however, wish to understand---and so shall recast the problem as
one of random signal analysis. We will state a problem in random
signal analysis, and the reader can confirm for themself that it is
equivalent to a Bell test. Then we shall derive a correlation
coefficient.

\section{The Problem}

There is a transmitter that sends a {\em{signal}} randomly from the
set

\begin{equation}
  S=\{\curvearrowleft\,,\,\curvearrowright\}
\end{equation}

The transmission goes into both of two channels. Each channel attaches
a {\em{tag}} to the signal, according to an algorithm to be specified
below, and re-transmits the tagged signal. The tag comes from the set

\begin{equation}
  T=\{\oplus\,,\,\ominus\}
\end{equation}

The tagging algorithm works as follows. The channel is ``tuned'' by an
angular setting $\zeta\in[0,2\pi]$. Let $r$ represent a number chosen
uniformly from $[0,1]$. Now suppose the signal $\sigma$ is
$\curvearrowleft$. In that case, if $r < \cos^2 \zeta$ then
re-transmit $(\oplus\,,\,\curvearrowleft)$. Otherwise re-transmit
$(\ominus\,,\,\curvearrowleft)$. On the other hand, suppose the signal
is $\sigma$ is $\curvearrowright$. Then, if $r < \sin^2 \zeta$
re-transmit $(\oplus\,,\,\curvearrowright)$, else re-transmit
$(\ominus\,,\,\curvearrowright)$.

At the end of both channels is a receiver-recorder, which makes a
record of received pairs of tagged signals, for some pair of
``tunings'' $(\zeta_1,\zeta_2)$ for the two channels. For example, one
hundred thousand or one million pairs of tagged signals might be
recorded.

Now suppose we map tags to numbers, $T\to T^{\prime}=\{-1,+1\}$, thus:
\begin{align}
  \oplus \mapsto +1 \\
  \ominus \mapsto -1
\end{align}
The problem is to use these numbers to calculate a correlation
coefficient $\rho$, characterizing the correlation between tags in the
received signal pairs.

\section{Solution}

We will use subscripts to refer to channel numbers. Thus, for example,
$\zeta_2$ may refer to a $\zeta$ parameter for channel~2, $\tau_1$ to
a tag value for channel~1, and so on. An unsubscripted letter may
refer to either channel. Thus, for instance, $\tau$ may stand in for
either $\tau_1$ or $\tau_2$. And so on like that.

We will use more or less conventional probability notation, though
also always adding the letter ``$\lambda$'' as a condition, meaning
something such as ``any relevant information we may so far have
neglected''. It pays to be cautious.

Note also that all angles will be in some relation relative to each
other, and positioned as a whole with respect to some ``landmark.'' We
will call the landmark $\phi_1$ and associate it, purely for
convenience, with the ``tuning'' of channel~1. The landmark may be any
angle, and thus ``$\phi_1\in[0,2\pi]$'' will often appear as a
condition. The correlation coefficient we calculate, however, will be
coordinate-free. The angle $\phi_1$ will appear in the final
expression only in its role as an angle relative to~$\phi_2$.

By the problem definition, one immediately gets
\begin{align}
  P(\sigma=\,\curvearrowleft \,|\, \lambda) &= \frac{1}{2} \\
  P(\sigma=\,\curvearrowright \,|\, \lambda) &= \frac{1}{2}
\end{align}
and
\begin{align}
  P(\tau=\,\oplus \,|\, \sigma=\,\curvearrowleft\,,\; \zeta=\phi\,,\; \phi_1\in[0,2\pi]\,,\; \lambda) &= \cos^2 \phi \\
  P(\tau=\,\ominus \,|\, \sigma=\,\curvearrowleft\,,\; \zeta=\phi\,,\; \phi_1\in[0,2\pi]\,,\; \lambda) &= \sin^2 \phi \\
  P(\tau=\,\oplus \,|\, \sigma=\,\curvearrowright\,,\; \zeta=\phi\,,\; \phi_1\in[0,2\pi]\,,\; \lambda) &= \sin^2 \phi \\
  P(\tau=\,\ominus \,|\, \sigma=\,\curvearrowright\,,\; \zeta=\phi\,,\; \phi_1\in[0,2\pi]\,,\; \lambda) &= \cos^2 \phi
\end{align}

We want to construct a table of probabilities of tagged signal pairs
received by the receiver-recorder, so let us start by finding an
expression for the following.
\begin{multline}
  P_1 = P(\sigma=\,\curvearrowleft\,,\; \tau_1=\,\oplus\,,\; \tau_2=\,\oplus \,|\,
  \zeta_1=\phi_1\,,\; \zeta_2=\phi_2 \\ \phi_1\in[0,2\pi]\,,\; \lambda)
\end{multline}
However, because that does not fit well into a line of text, let us
first introduce a shorthand, by writing something like
\begin{equation}
  P_1 = P(\curvearrowleft\,\oplus_1\,\oplus_2\,|\,\phi_1\,,\; \phi_2\,,\;
  [0,2\pi]\,,\; \lambda)
\end{equation}
to mean the same thing. Then, by probability theory, and taking into
account that $\phi_1$ and~$\phi_2$ respectively pertain exclusively to
channel~1 or~channel~2 (so conditionality on the opposite channel's
$\phi$ may be dropped),
\begin{align}
  P_1 &= P(\curvearrowleft\,\oplus_1\,\oplus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) \\
      &= P(\curvearrowleft\,|\, \lambda) P(\oplus_1\,\oplus_2\,|\,\curvearrowleft\,,\;\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) \\
      &= P(\curvearrowleft\,|\, \lambda) P_{11} P_{12} = \frac{1}{2} P_{11} P_{12}
\end{align}
where
\begin{align}
  P_{11} &= P(\oplus_1\,|\,\curvearrowleft\,,\;\phi_1\,,\; [0,2\pi]\,,\; \lambda) = \cos^2 \phi_1 \\
  P_{12} &= P(\oplus_2\,|\,\curvearrowleft\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) = \cos^2 \phi_2
\end{align}

By that and similar calculations the following table may be
constructed.
\begin{align}
  P(\curvearrowleft\,\oplus_1\,\oplus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) &= \frac{1}{2} \cos^2 \phi_1\, \cos^2 \phi_2 \\
  P(\curvearrowleft\,\oplus_1\,\ominus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) &= \frac{1}{2} \cos^2 \phi_1\, \sin^2 \phi_2 \\
  P(\curvearrowleft\,\ominus_1\,\oplus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) &= \frac{1}{2} \sin^2 \phi_1\, \cos^2 \phi_2 \\
  P(\curvearrowleft\,\ominus_1\,\ominus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) &= \frac{1}{2} \sin^2 \phi_1\, \sin^2 \phi_2 \\
  P(\curvearrowright\,\oplus_1\,\oplus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) &= \frac{1}{2} \sin^2 \phi_1\, \sin^2 \phi_2 \\
  P(\curvearrowright\,\oplus_1\,\ominus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) &= \frac{1}{2} \sin^2 \phi_1\, \cos^2 \phi_2 \\
  P(\curvearrowright\,\ominus_1\,\oplus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) &= \frac{1}{2} \cos^2 \phi_1\, \sin^2 \phi_2 \\
  P(\curvearrowright\,\ominus_1\,\ominus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) &= \frac{1}{2} \cos^2 \phi_1\, \cos^2 \phi_2
\end{align}
Disregarding the signal values gives (by addition of probabilities)
\begin{multline}
  \label{coscos}
  P(\oplus_1\,\oplus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) \\
  = P(\ominus_1\,\ominus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) \\
  = \frac{1}{2} \cos^2 \phi_1\, \cos^2 \phi_2 + \frac{1}{2} \sin^2 \phi_1\, \sin^2 \phi_2
\end{multline}
and
\begin{multline}
  \label{cossin}
  P(\oplus_1\,\ominus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) \\
  = P(\ominus_1\,\oplus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) \\
  = \frac{1}{2} \cos^2 \phi_1\, \sin^2 \phi_2 + \frac{1}{2} \sin^2 \phi_1\, \cos^2 \phi_2
\end{multline}

We want to calculate the correlation coefficient
\begin{equation}
  \label{corrcoef}
  \rho = \frac{E(\tau'_1 \tau'_2)}{\sqrt{E({\tau'_1}^2)}\sqrt{E({\tau'_2}^2)}}
\end{equation}
where $\tau'_1, \tau'_2 \in T^{\prime}$ and the expectations $E$ are
calculated with respect to the conditional probabilities derived
above. The numerator is the covariance and the denominator is the
product of the standard deviations.

The choice of values for the elements of $T^{\prime}$ makes it so the
standard deviations in (\ref{corrcoef}) equal one, and thus the
correlation coefficient simplifies to the covariance
\begin{equation}
  \rho = E(\tau'_1 \tau'_2)
\end{equation}
which we now must calculate. To do so, not only must we compute a sum
weighted by the probabilities in (\ref{coscos}) and~(\ref{cossin}),
but we must also eliminate the $\phi_1\in[0,2\pi]$ condition by
integrating with respect to $\phi_1$.  We have no information ahead of
time on what this angular landmark~$\phi_1$ will be, and so the
probability distribution is uniform, which simplifies our
integration. We will encounter a complication, but it will be minor:
we will have to break the integration into pieces.

First let us calculate the sum for (\ref{coscos}) and~(\ref{cossin})
(call the sum $\rho^{\prime}$), and then we will integrate the result of that
sum.
\begin{multline}
  \rho^{\prime} 
  = (+1)(+1) P(\oplus_1\,\oplus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) \\
  + (+1)(-1) P(\oplus_1\,\ominus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) \\
  + (-1)(+1) P(\ominus_1\,\oplus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda) \\
  + (-1)(-1) P(\ominus_1\,\ominus_2\,|\,\phi_1\,,\; \phi_2\,,\; [0,2\pi]\,,\; \lambda)
\end{multline}
Substituting for the probabilities gives
\begin{multline}
  \rho^{\prime} = \cos^2 \phi_1\, \cos^2 \phi_2 - \cos^2 \phi_1\, \sin^2 \phi_2 \\
  - \sin^2 \phi_1\, \cos^2 \phi_2 + \sin^2 \phi_1\, \sin^2 \phi_2
\end{multline}
and so
\begin{align}
  \rho^{\prime} &= (\cos^2 \phi_2 - \sin^2 \phi_2) (\cos^2 \phi_1 - \sin^2 \phi_1) \\
                &=\cos(2\phi_2)\,\cos(2\phi_1)
\end{align}

\end{document}
